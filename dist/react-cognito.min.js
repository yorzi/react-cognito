!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-redux"),require("amazon-cognito-identity-js"),require("aws-sdk")):"function"==typeof define&&define.amd?define(["react","react-redux","amazon-cognito-identity-js","aws-sdk"],t):"object"==typeof exports?exports.ReactCognito=t(require("react"),require("react-redux"),require("amazon-cognito-identity-js"),require("aws-sdk")):e.ReactCognito=t(e.React,e.ReactRedux,e.AmazonCognitoIdentity,e.AWS)}(this,function(e,t,n,r){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(1);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(6);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(8);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var c=n(15);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var s=n(5);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var a=n(4);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var f=n(16);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var l=n(11);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var d=n(12);Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var O=n(13);Object.keys(O).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return O[e]}})});var g=n(10);Object.keys(g).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})});var _=n(14);Object.keys(_).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}})});var I=n(9);Object.keys(I).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return I[e]}})})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={configure:function(e){return{type:"COGNITO_CONFIGURE",config:e}},authenticated:function(e){return{type:"COGNITO_AUTHENTICATED",user:e}},loggingIn:function(e){return{type:"COGNITO_LOGGING_IN",attributes:e}},login:function(e){return{type:"COGNITO_LOGIN",creds:e}},logout:function(){return{type:"COGNITO_LOGOUT"}},partialLogout:function(){return{type:"COGNITO_PARTIAL_LOGOUT"}},loginFailure:function(e,t){return{type:"COGNITO_LOGIN_FAILURE",user:e,error:t}},mfaRequired:function(e){return{type:"COGNITO_LOGIN_MFA_REQUIRED",user:e}},newPasswordRequired:function(e){return{type:"COGNITO_LOGIN_NEW_PASSWORD_REQUIRED",user:e}},newPasswordRequiredFailure:function(e,t){return{type:"COGNITO_NEW_PASSWORD_REQUIRED_FAILURE",user:e,error:t}},emailVerificationRequired:function(e){return{type:"COGNITO_EMAIL_VERIFICATION_REQUIRED",attributes:e}},emailVerificationFailed:function(e,t){return{type:"COGNITO_EMAIL_VERIFICATION_FAILED",user:e,error:t}},beginPasswordResetFlow:function(e,t){return{type:"COGNITO_BEGIN_PASSWORD_RESET_FLOW",user:e,error:t}},continuePasswordResetFlow:function(e){return{type:"COGNITO_CONTINUE_PASSWORD_RESET_FLOW",user:e}},finishPasswordResetFlow:function(e){return{type:"COGNITO_FINISH_PASSWORD_RESET_FLOW",error:e}},updateAttributes:function(e){return{type:"COGNITO_UPDATE_USER_ATTRIBUTES",attributes:e}},confirmationRequired:function(e,t){return{type:"COGNITO_USER_UNCONFIRMED",user:e,email:t}},confirmFailed:function(e,t){return{type:"COGNITO_USER_CONFIRM_FAILED",user:e,error:t}},clearCache:function(){return{type:"COGNITO_CLEAR_CACHE"}}};t.Action=n},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkAttrList=t.updateAttributes=t.getUserAttributes=t.sendAttributeVerificationCode=void 0;var r=n(1),o=function(e,t){return new Promise(function(n,r){e.getAttributeVerificationCode(t,{onSuccess:function(){return n(!1)},inputVerificationCode:function(){return n(!0)},onFailure:function(e){return r(e.message)}})})},i=function(e){return new Promise(function(t,n){return e.getUserAttributes(function(e,r){if(e)n(e.message);else{for(var o={},i=0;i<r.length;i+=1){var u=r[i].getName(),c=r[i].getValue();o[u]=c}t(o)}})})},u=function(e){return Object.keys(e).map(function(t){return{Name:t,Value:e[t]}})},c=function(e,t){return new Promise(function(n,o){var i=u(t);e.updateAttributes(i,function(e){e?o(e.message):n(r.Action.updateAttributes(t))})})};t.sendAttributeVerificationCode=o,t.getUserAttributes=i,t.updateAttributes=c,t.mkAttrList=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emailVerificationFlow=t.registerUser=t.performLogin=t.authenticate=void 0;var r=n(7),o=n(18),i=n(1),u=n(4),c=n(8),s=function(e,t){return new Promise(function(n){return(0,u.sendAttributeVerificationCode)(e,"email").then(function(e){n(e?i.Action.emailVerificationRequired(t):i.Action.loggingIn(t))},function(e){n(i.Action.emailVerificationFailed(e,t))})})},a=function(e,t,n){return new Promise(function(r,i){var u=(0,c.buildLogins)(e,t,n),s=new o.CognitoIdentityCredentials(u);s.refresh(function(e){e?i(e.message):r(s)})})},f=function(e,t){return new Promise(function(n,r){null!=e?e.getSession(function(r,o){if(r)n(i.Action.loginFailure(e,r.message));else{var u=o.getIdToken().getJwtToken(),c=e.getUsername();a(c,u,t).then(function(e){return n(i.Action.login(e))},function(t){return n(i.Action.loginFailure(e,t))})}}):r("user is null")})},l=function(e,t,n,o,u){return new Promise(function(o,c){var s=new r.AuthenticationDetails({Username:e,Password:t}),a=new r.CognitoUser({Username:e,Pool:n});a.authenticateUser(s,{onSuccess:function(){u(i.Action.authenticated(a)),o()},onFailure:function(e){"UserNotConfirmedException"===e.code?(u(i.Action.confirmationRequired(a)),o()):(u(i.Action.loginFailure(a,e.message)),c(e))},mfaRequired:function(){u(i.Action.mfaRequired(a)),o()},newPasswordRequired:function(){u(i.Action.newPasswordRequired(a)),o()}})})},d=function(e,t,n,r,o){return new Promise(function(t,c){return e.signUp(n,r,(0,u.mkAttrList)(o),null,function(u,s){u?c(u.message):t(s.userConfirmed===!1?i.Action.confirmationRequired(s.user,o.email):l(n,r,e))})})};t.authenticate=l,t.performLogin=f,t.registerUser=d,t.emailVerificationFlow=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CognitoState={LOGGED_OUT:"LOGGED_OUT",AUTHENTICATED:"AUTHENTICATED",LOGGING_IN:"LOGGING_IN",LOGGED_IN:"LOGGED_IN",NEW_PASSWORD_REQUIRED:"NEW_PASSWORD_REQUIRED",MFA_REQUIRED:"MFA_REQUIRED",EMAIL_VERIFICATION_REQUIRED:"EMAIL_VERIFICATION_REQUIRED",CONFIRMATION_REQUIRED:"CONFIRMATION_REQUIRED"}},function(e,t){e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,n){return new Promise(function(r,o){return e.changePassword(t,n,function(e,t){e?o(e.message):r(t)})})},r=function(e,t,n){var r="cognito-idp."+n.region+".amazonaws.com",o=r+"/"+n.userPool,i={IdentityPoolId:n.identityPool,Logins:{},LoginId:e};return i.Logins[o]=t,i};t.changePassword=n,t.buildLogins=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Confirm=void 0;var o=n(2),i=r(o),u=n(3),c=n(1),s=function(e){return i.default.cloneElement(e.children,{error:e.error,onSubmit:e.onSubmit,onResend:e.onResend,onCancel:e.onCancel})},a=function(e,t,n){return new Promise(function(r,o){t.confirmRegistration(e,!0,function(e){e?(n(c.Action.confirmFailed(t)),o(e.message)):(n(c.Action.partialLogout()),r(t))})})},f=function(e,t){return new Promise(function(n,r){e.resendConfirmationCode(function(o){o?(t(c.Action.confirmationRequired(e)),r(o.message)):(t(c.Action.confirmationRequired(e)),n(e))})})},l=function(e){return{error:e.cognito.error,user:e.cognito.user}},d=function(e){return{confirmPartial:function(t,n){return a(t,n,e)},onCancel:function(){return e(c.Action.logout())},onResendPartial:function(t){return f(t,e)}}},O=function(e,t,n){return Object.assign({},n,e,t,{onSubmit:function(n){return t.confirmPartial(n,e.user)},onResend:function(){return t.onResendPartial(e.user)}})};t.Confirm=(0,u.connect)(l,d,O)(s)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.EmailVerification=t.verifyEmail=void 0;var o=n(2),i=r(o),u=n(3),c=n(1),s=function(e){return i.default.cloneElement(e.children,{error:e.error,onSubmit:e.onSubmit,onCancel:e.onCancel})},a=t.verifyEmail=function(e,t,n){return new Promise(function(r,o){t.verifyAttribute("email",e,{onSuccess:function(){n(c.Action.login(t)),r()},inputVerificationCode:function(){n(c.Action.emailVerificationRequired(t)),o()},onFailure:function(e){n(c.Action.emailVerificationFailed(t,e.message)),o()}})})},f=function(e){return{error:e.cognito.error,user:e.cognito.user}},l=function(e){return{verifyPartial:function(t,n){return a(t,n,e)},onCancel:function(){return e(c.Action.logout())}}},d=function(e,t,n){return Object.assign({},n,e,t,{onSubmit:function(n){return t.verifyPartial(n,e.user)}})};t.EmailVerification=(0,u.connect)(f,l,d)(s)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Login=void 0;var o=n(2),i=r(o),u=n(3),c=n(5),s=n(1),a=function(e){return i.default.cloneElement(e.children,{username:e.username,email:e.email,onSubmit:e.onSubmit,clearCache:e.clearCache})},f=function(e){var t="";return e.cognito.user?t=e.cognito.user.getUsername():e.cognito.userName&&(t=e.cognito.cache.userName),{username:t,email:e.cognito.cache.email,config:e.cognito.config,userPool:e.cognito.userPool}},l=function(e){return{authenticator:function(t,n,r,o){return(0,c.authenticate)(t,n,r,o,e)},clearCache:function(){return e(s.Action.clearCache())}}},d=function(e,t,n){return Object.assign({},n,e,{onSubmit:function(n,r){return t.authenticator(n,r,e.userPool,e.config)},clearCache:t.clearCache})},O=(0,u.connect)(f,l,d)(a);t.Login=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Logout=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),a=r(s),f=n(1),l=t.Logout=function(e){function t(){var e,n,r,u;o(this,t);for(var c=arguments.length,s=Array(c),a=0;a<c;a++)s[a]=arguments[a];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.onClick=function(e){var t=r.context.store,n=t.getState();n.cognito.user.signOut(),e.preventDefault(),t.dispatch(f.Action.logout()),r.props.onLogout()},u=n,i(r,u)}return u(t,e),c(t,[{key:"render",value:function(){return a.default.cloneElement(this.props.children,{onClick:this.onClick})}}]),t}(a.default.Component);l.contextTypes={store:s.PropTypes.object},l.propTypes={children:a.default.PropTypes.any.isRequired,onLogout:a.default.PropTypes.func},l.defaultProps={onLogout:function(){}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NewPasswordRequired=void 0;var o=n(2),i=r(o),u=n(3),c=n(1),s=function(e){return i.default.cloneElement(e.children,{error:e.error,onSubmit:e.onSubmit})},a=function(e,t,n,r,o){return t.completeNewPasswordChallenge(e,r,{onSuccess:function(){return o(c.Action.authenticated(t))},onFailure:function(e){return o(c.Action.newPasswordRequiredFailure(t,e.message))},mfaRequired:function(){return o(c.Action.mfaRequired(t))},newPasswordRequired:function(){return o(c.Action.newPasswordRequired(t))}})},f=function(e){return{error:e.cognito.error,user:e.cognito.user,config:e.cognito.config}},l=function(e){return{setNewPasswordPartial:function(t,n,r,o){return a(t,n,r,o,e)}}},d=function(e,t,n){return Object.assign({},n,e,{onSubmit:function(n,r){return t.setNewPasswordPartial(n,e.user,e.config,r)}})};t.NewPasswordRequired=(0,u.connect)(f,l,d)(s)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordReset=void 0;var o=n(2),i=r(o),u=n(3),c=n(7),s=n(1),a=function(e){return i.default.cloneElement(e.children,{username:e.username,sendVerificationCode:e.sendVerificationCode,setPassword:e.setPassword})},f=function(e,t){var n=new c.CognitoUser({Username:e,Pool:t});return n},l=function(e,t,n,r,o){return new Promise(function(i,u){var c=f(e,t);c.confirmPassword(n,r,{onSuccess:function(){o(s.Action.finishPasswordResetFlow()),i()},onFailure:function(e){o(s.Action.beginPasswordResetFlow(c,e.message)),u(e)}})})},d=function(e,t,n){return new Promise(function(r,o){var i=f(e,t);i.forgotPassword({onSuccess:function(){n(s.Action.continuePasswordResetFlow(i)),r()},onFailure:function(e){n(s.Action.beginPasswordResetFlow(i,e.message)),o(e)}})})},O=function(e){var t={user:e.cognito.user,username:"",userPool:e.cognito.userPool};return null!=e.cognito.user&&(t.username=e.cognito.user.getUsername()),t},g=function(e){return{sendVerificationCodePartial:function(t,n){return d(t,n,e)},setPasswordPartial:function(t,n,r,o){return l(t,n,r,o,e)}}},_=function(e,t,n){return Object.assign({},n,e,{sendVerificationCode:function(n){return t.sendVerificationCodePartial(n,e.userPool)},setPassword:function(n,r,o){return t.setPasswordPartial(n,e.userPool,r,o)}})};t.PasswordReset=(0,u.connect)(O,g,_)(a)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var n=null!==e.cognito.user;return!(!n||!t)||!n&&!t},r=function(e,t){return new Promise(function(r){r(void 0!==t.loggedIn?n(e,t.loggedIn):n(e,!0))})},o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(arguments[3],arguments[4]),i=arguments[5],u=e.getState(),c=t;void 0!==n.forbiddenUrl&&(c=n.forbiddenUrl),r(u,n).then(function(e){e||o(c),i()})},i=function(e,t){return function(n){return function(r,i,u){return o(e,t,n,r,i,u)}}};t.createGuard=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityPoolLogin=t.emailVerificationRequired=t.fetchAttributes=t.direct=t.enable=t.setupCognito=void 0;var r=n(1),o=n(4),i=n(5),u=n(6),c=function(e,t){e.subscribe(function(){var n=e.getState(),r=e.dispatch;t(n,r)})},s=function(e,t){if(e.cognito.state===u.CognitoState.AUTHENTICATED){var n=e.cognito.user;(0,o.getUserAttributes)(n).then(function(e){"true"!==e.email_verified?(0,i.emailVerificationFlow)(n,e).then(t):t(r.Action.loggingIn(e))})}},a=function(e,t){if(e.cognito.state===u.CognitoState.AUTHENTICATED){var n=e.cognito.user;(0,o.getUserAttributes)(n).then(function(e){t(r.Action.loggingIn(e))})}},f=function(e,t){e.cognito.state===u.CognitoState.AUTHENTICATED&&t(r.Action.loggingIn())},l=function(e,t){e.cognito.state===u.CognitoState.LOGGING_IN&&(0,i.performLogin)(e.cognito.user,e.cognito.config).then(t)},d=function(e,t){e.dispatch(r.Action.configure(t)),c(e,s),c(e,l)};t.setupCognito=d,t.enable=c,t.direct=f,t.fetchAttributes=a,t.emailVerificationRequired=s,t.identityPoolLogin=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cognito=void 0;var r=n(7),o=n(6),i={user:null,cache:{userName:null,email:null},state:o.CognitoState.LOGGED_OUT,error:"",userPool:null,attributes:{},creds:null,config:{region:null,userPool:null,clientId:null,identityPool:null}},u=function(e,t){AWS.config.region=t.config.region;var n=new r.CognitoUserPool({UserPoolId:t.config.userPool,ClientId:t.config.clientId}),o=n.getCurrentUser();return Object.assign({},e,{config:t.config,userPool:n,user:o})},c=function(e,t){var n=Object.assign({},e);return t&&(n.attributes=t),n};t.cognito=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments[1];switch(t.type){case"COGNITO_CONFIGURE":return u(e,t);case"COGNITO_AUTHENTICATED":return Object.assign({},e,{user:t.user,cache:{userName:null,email:null},error:"",state:o.CognitoState.AUTHENTICATED});case"COGNITO_CLEAR_CACHE":return Object.assign({},e,{cache:{userName:null,email:null}});case"COGNITO_LOGGING_IN":return Object.assign({},e,{state:o.CognitoState.LOGGING_IN,attributes:t.attributes});case"COGNITO_LOGIN":return Object.assign({},e,c({error:"",creds:t.creds,state:o.CognitoState.LOGGED_IN},t.attributes));case"COGNITO_LOGOUT":return Object.assign({},e,{user:null,error:"",creds:null,state:o.CognitoState.LOGGED_OUT});case"COGNITO_PARTIAL_LOGOUT":return Object.assign({},e,{user:null,userName:e.user.username,error:"",creds:null,state:o.CognitoState.LOGGED_OUT});case"COGNITO_LOGIN_FAILURE":return Object.assign({},e,{user:t.user,state:o.CognitoState.LOGGED_OUT,error:t.error});case"COGNITO_LOGIN_MFA_REQUIRED":return Object.assign({},e,{user:t.user,error:"",state:o.CognitoState.MFA_REQUIRED});case"COGNITO_LOGIN_NEW_PASSWORD_REQUIRED":return Object.assign({},e,{user:t.user,error:"",state:o.CognitoState.NEW_PASSWORD_REQUIRED});case"COGNITO_USER_UNCONFIRMED":return Object.assign({},e,{user:t.user,state:o.CognitoState.CONFIRMATION_REQUIRED,cache:{userName:t.user.username,email:t.email}});case"COGNITO_USER_CONFIRM_FAILED":return Object.assign({},e,{user:t.user,state:o.CognitoState.CONFIRMATION_REQUIRED,error:t.error});case"COGNITO_NEW_PASSWORD_REQUIRED_FAILURE":return Object.assign({},e,{error:t.error,state:o.CognitoState.NEW_PASSWORD_REQUIRED});case"COGNITO_EMAIL_VERIFICATION_REQUIRED":return Object.assign({},e,c({error:"",state:o.CognitoState.EMAIL_VERIFICATION_REQUIRED},t.attributes));case"COGNITO_EMAIL_VERIFICATION_FAILED":return Object.assign({},e,c({error:t.error,state:o.CognitoState.EMAIL_VERIFICATION_REQUIRED},t.attributes));case"COGNITO_BEGIN_PASSWORD_RESET_FLOW":return Object.assign({},e,{error:t.error});case"COGNITO_CONTINUE_PASSWORD_RESET_FLOW":return e;case"COGNITO_FINISH_PASSWORD_RESET_FLOW":return e;case"COGNITO_UPDATE_USER_ATTRIBUTES":return Object.assign({},e,{attributes:Object.assign({},e.attributes,t.attributes),state:o.CognitoState.AUTHENTICATED});default:return e}}},function(e,t){e.exports=r}])});
//# sourceMappingURL=react-cognito.min.js.map